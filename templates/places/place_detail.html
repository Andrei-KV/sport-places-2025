{% extends 'base/base.html' %}
{% load static %}

{% block title %}{{ place.name }}{% endblock %}

{% block content %}
    <h1>{{ place.name }}</h1>
    <p>{{ place.description }}</p>

    {# --- Секция для фотогалереи --- #}
    <h2>Фотографии</h2>
    <div class="photo-gallery-wrapper">
        {% if photos %}
            <div class="photo-gallery">
                {% for photo in photos %}
                    <img src="{{ photo.image.url }}" alt="{{ place.name }}">
                {% endfor %}
            </div>
        {% else %}
            <div class="no-photos-message">
                <p>Нет фото</p>
            </div>
        {% endif %}
    </div>

    {# --- Секция для карты --- #}
    {% if place_map %}
        <h2>Местоположение</h2>
        <div class="map-container">
            {{ place_map|safe }}
        </div>
    {% endif %}
    
    <h2>Рейтинг: {{ average_rating|floatformat:1 }} / 5</h2>

    <h3>Комментарии:</h3>
    {% for comment in comments %}
        <div>
            <strong>{{ comment.user.username }}</strong> ({{ comment.created_at|date:"d.m.Y H:i" }}):
            <p>{{ comment.text }}</p>
        </div>
        <hr>
    {% empty %}
        <p>Комментариев пока нет. Будьте первыми!</p>
    {% endfor %}

    <hr>
    
    <h2>Оставить комментарий</h2>
    <form method="post">
        {% csrf_token %}
        {{ comment_form.as_p }}
        <button type="submit" name="comment_submit">Отправить</button>
    </form>

    <h2>Оценить площадку</h2>
    <form method="post">
        {% csrf_token %}
        {{ rating_form.as_p }}
        <button type="submit" name="rating_submit">Оценить</button>
    </form>
{% endblock %}